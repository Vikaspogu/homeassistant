icon: si:tesla
title: Tesla
path: tesla
id: tesla
cards:
  - type: "vertical-stack"
    cards:
    - type: "custom:button-card"
      color_type: blank-card
    - type: custom:decluttering-card
      template: navigation_chips
      variables:
        - nav_path_1: /lovelace/rooms
        - nav_icon_1: mdi:bed
        - nav_path_2: /lovelace/system
        - nav_icon_2: mdi:cog
          
    ## ROW 1 ###################################################################################################################
    - type: 'custom:button-card'
      template: card_title
      name: Quinjet
    - type: horizontal-stack
      cards:
      - type: custom:button-card
        template: edge
      - !include '../includes/tesla.yaml'
      - type: custom:button-card
        template: edge

    ## Location ###################################################################################################################
    - type: 'custom:button-card'
      template: card_title
      name: Location
    - type: horizontal-stack
      cards:
      - type: custom:button-card
        template: edge
      - type: map
        aspect_ratio: '16:9'
        default_zoom: 13
        entities:
          - device_tracker.tesla_location
      - type: custom:button-card
        template: edge

    ## Car glance stats ###################################################################################################################
    - type: 'custom:button-card'
      template: card_title
      name: Glance
    - type: horizontal-stack
      cards:
      - type: custom:button-card
        template: edge
      - type: 'custom:button-card'
        template: card_battery
        entity: sensor.tesla_battery_level
        variables:
          ulm_card_battery_charger_type_entity_id: sensor.tesla_battery_level
          ulm_card_battery_battery_level_danger: 10
          ulm_card_battery_battery_level_warning: 30
          ulm_card_battery_name: Battery Level
      - type: custom:mushroom-entity-card
        entity: sensor.tesla_state
        icon_color: amber
        name: Car State
      - type: custom:button-card
        template: edge
    - type: horizontal-stack
      cards:
      - type: custom:button-card
        template: edge
      - type: 'custom:button-card'
        template: card_binary_sensor
        variables:
          ulm_card_binary_sensor: true
          ulm_show_last_changed: true
          ulm_card_binary_sensor_name: Plugged In
        entity: binary_sensor.tesla_plugged_in
      - type: 'custom:button-card'
        template: card_binary_sensor
        variables:
          ulm_card_binary_sensor: true
          ulm_show_last_changed: true
          ulm_card_binary_sensor_name: Park Brake
        entity: binary_sensor.tesla_park_brake
      - type: custom:button-card
        template: edge
    - type: horizontal-stack
      cards:
      - type: custom:button-card
        template: edge
      - type: custom:mushroom-template-card
        primary: 'Sentry Mode'
        entity: binary_sensor.tesla_sentry_mode
        icon: mdi:cctv
        multiline_secondary: false
        tap_action:
          action: more-info
        secondary: |-
          {{ states(entity) }}
        icon_color: |
          {%- if is_state(entity, 'on') %} 
          deep-purple
          {% endif %}
        card_mod:
          style:
            mushroom-shape-icon$: |
              ha-icon {
                {% if is_state(config.entity, 'on') %}
                --icon-animation: scan 5s ease-in-out infinite;
                transform-origin: 90% 80%
                {% endif %}
              }
              @keyframes scan {
                0%, 100% { transform: rotate(20deg); }
                50% { transform: rotate(-15deg); }
              }
      - type: custom:mushroom-entity-card
        entity: sensor.tesla_speed_mph
        icon_color: amber
      - type: custom:button-card
        template: edge
    - type: horizontal-stack
      cards:
      - type: custom:button-card
        template: edge
      - type: custom:mushroom-template-card
        primary: Car Health
        entity: binary_sensor.tesla_healthy
        icon: mdi:heart
        multiline_secondary: false
        tap_action:
          action: more-info
        secondary: |-
          {{ states(entity) }}
        icon_color: |
          {%- if is_state(entity, 'on') %} 
          blue
          {% endif %}
        card_mod:
          style:
            mushroom-shape-icon$: |
              {%- if is_state(entity, 'on') %} 
              ha-icon {
                --icon-animation: pulse 2s ease-in-out infinite;
              }
              {% endif %}
      - type: 'custom:button-card'
        template: card_binary_sensor
        variables:
          ulm_card_binary_sensor: true
          ulm_show_last_changed: true
          ulm_card_binary_sensor_name: Window Status
        entity: binary_sensor.tesla_windows_open
      - type: custom:button-card
        template: edge

    ## Auto entites Tesla ###################################################################################################################
    - type: 'custom:button-card'
      template: card_title
      name: Detailed View
    - type: "custom:auto-entities"
      card:
        type: "grid"
        columns: 2
        square: false
      card_param: "cards"
      sort:
        method: last-changed
        ignore_case: true
      filter:
        include:
          - entity_id: "sensor.tesla_*"
            options:
              type: custom:mushroom-entity-card
              entity: this.entity_id
              icon_color: amber
          - entity_id: "binary_sensor.tesla_*"
            options:
              type: custom:mushroom-entity-card
              entity: this.entity_id
              icon_color: amber
        exclude:
          - state: "unavailable"
          - state: "Unknown"
          - entity_id: "sensor.tesla_wall_*"
          - entity_id: "binary_sensor.tesla_wall_*"

    ## Auto entities Tesla wall connector ###################################################################################################################
    - type: 'custom:button-card'
      template: card_title
      name: Tesla Wall Connector
    - type: "custom:auto-entities"
      card:
        type: "grid"
        columns: 2
        square: false
      card_param: "cards"
      sort:
        method: last-changed
        ignore_case: true
      filter:
        include:
          - entity_id: "sensor.tesla_wall_*"
            options:
              type: "custom:button-card"
              template: "card_generic_swap"
          - entity_id: "binary_sensor.tesla_wall_*"
            options:
              type: "custom:button-card"
              template: "card_generic_swap"
        exclude:
          - state: "unavailable"
          - state: "Unknown"
